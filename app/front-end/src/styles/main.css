/* main.css - entry point para estilos modulares */

/* =====================================================
   MAIN CSS - STRUCTURED ARCHITECTURE
   ===================================================== */

/* 01 - Foundations (reset, variables, typography) */
@import url('./01-foundations/reset.css');
@import url('./variables.css'); /* Enhanced design tokens with terminal improvements */
@import url('./01-foundations/typography.css');

/* Terminal-specific tokens */
@import url('./terminal-tokens.css');

/* 02 - Utilities (animations, spacing, colors, effects) */
@import url('./02-utilities/index.css');

/* 03 - Components (layout, forms, modals, interactive) */
@import url('./03-components/index.css');

/* 04 - Features (sections, header, skills, highlights, terminal) */
@import url('./04-features/index.css');

/* 05 - Optimizations (performance, accessibility, compatibility) */
@import url('./05-optimizations/index.css');

/* ===== Global background + bleed + reveal ===== */
:root {
  --app-bg: #0b0f17;
  --bg-0: #0b0f17;
  --bg-1: #0e1320;
  --bg-2: #11182a;
  --surface: rgb(255, 255, 255, 0.02);
  --ring: rgb(139, 92, 246, 0.12);
  --header-h: var(--nav-h, 68px);

  /* para glows */
  --indigo-500: 99, 102, 241; /* #6366f1 */
  --violet-500: 139, 92, 246; /* #8b5cf6 */

  /* ruido sutil embebido */
  --noise-img: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='80' height='80'><filter id='n'><feTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='2' stitchTiles='stitch'/></filter><rect width='100%' height='100%' filter='url(#n)' opacity='0.04'/></svg>");

  /* knobs de calidad */
  --aurora-blur: 4px; /* antes 8px -> menos velado */
  --aurora-a: 0.1; /* intensidad aurora indigo */
  --aurora-b: 0.08; /* intensidad aurora violeta */
  --vignette: 0.25; /* fuerza de viñeta */
  --noise-opacity: 0.18; /* antes .45 -> menos “haze” */
  --grid-opacity: 0.006; /* líneas del grid más sutiles */
}

html,
body {
  height: 100%;
}

/* ===== Fondo de página (pro) ===== */
.curriculum-container {
  position: relative;
  isolation: isolate;
  min-height: 100%;
  scroll-behavior: smooth;
  background-color: var(--app-bg);

  /* base vertical + glows fijos (parallax suave) */
  background-image:
    linear-gradient(180deg, var(--bg-0) 0%, #0c111a 55%, var(--bg-0) 100%),
    radial-gradient(900px 600px at 20% 80%, rgb(var(--indigo-500), 0.1), transparent 60%),
    radial-gradient(800px 540px at 80% 20%, rgb(var(--violet-500), 0.08), transparent 55%),
    radial-gradient(700px 500px at 40% 40%, rgb(59, 130, 246, 0.05), transparent 50%);
  background-attachment: scroll, fixed, fixed, fixed;
  background-repeat: no-repeat;
  background-size: cover, auto, auto, auto;
}

/* aurora + viñeta fija */
.curriculum-container::before {
  content: '';
  position: fixed;
  inset: -20vmax;
  z-index: -1;
  pointer-events: none;
  background:
    radial-gradient(60% 40% at 18% 30%, rgb(99, 102, 241, var(--aurora-a)), transparent 60%),
    radial-gradient(50% 35% at 78% 70%, rgb(139, 92, 246, var(--aurora-b)), transparent 60%),
    radial-gradient(farthest-side at 50% 50%, transparent 62%, rgb(0, 0, 0, var(--vignette)) 100%);
  filter: blur(var(--aurora-blur));
  animation: auroraFloat 28s ease-in-out infinite alternate;
  transform: translate3d(0, 0, 0);
  will-change: transform, opacity;
}

/* grano + grid tenue para textura */
.curriculum-container::after {
  content: '';
  position: fixed;
  inset: 0;
  z-index: -1;
  pointer-events: none;
  background-image:
    var(--noise-img),
    repeating-linear-gradient(
      0deg,
      rgb(255, 255, 255, var(--grid-opacity)) 0 1px,
      transparent 1px 56px
    ),
    repeating-linear-gradient(
      90deg,
      rgb(255, 255, 255, var(--grid-opacity)) 0 1px,
      transparent 1px 56px
    );
  opacity: var(--noise-opacity);

  /* quita el soft-light para no lavar el contraste global */
  mix-blend-mode: normal;
}

/* ===== Loading / verificando sistema ===== */
.setup-loading {
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 100vh;
  padding: 2rem;
  box-sizing: border-box;
}

.setup-loading.setup-loading--overlay {
  position: fixed;
  inset: 0;
  z-index: 11000;

  /* Fondo muy tenue: reducir casi a un velo para dejar ver el contenido.
    Usamos blur más marcado y un ligero brighten para que el fondo no parezca negro. */
  background: rgb(11, 15, 23, 0.04);
  backdrop-filter: blur(10px) saturate(120%) brightness(1.06);
  transition:
    background 240ms ease,
    opacity 220ms ease,
    backdrop-filter 240ms ease;
}

.setup-loading-content {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 1rem;
  padding: 1.25rem 1.5rem;
  border-radius: 12px;
  max-width: 360px;
  width: 100%;

  /* Tarjeta muy sutil: apenas una placa semitransparente para el texto/rueda */
  background: rgb(255, 255, 255, 0.006);
  border: 1px solid rgb(255, 255, 255, 0.01);
  color: rgb(255, 255, 255, 0.92);
  box-shadow: 0 4px 10px rgb(0, 0, 0, 0.22);
  backdrop-filter: blur(6px) saturate(120%);
  text-align: center;
}

.setup-loading-spinner {
  width: 56px;
  height: 56px;
  border-radius: 50%;
  border: 4px solid rgb(255, 255, 255, 0.08);
  border-top-color: var(--ring, rgb(139, 92, 246, 0.28));
  animation: spin 1s linear infinite;
  box-shadow:
    0 6px 18px rgb(0, 0, 0, 0.5),
    inset 0 1px 0 rgb(255, 255, 255, 0.02);
}

.setup-loading-content p {
  margin: 0;
  font-weight: 600;
  color: var(--color-text-primary, #fff);
}

@keyframes spin {
  to {
    transform: rotate(360deg);
  }
}

@media (prefers-reduced-motion: reduce) {
  .setup-loading-spinner {
    animation: none;
    transform: none;
  }

  .curriculum-container::before {
    animation: none;
  }
}

/* Cuando la app está en estado de verificación global (isCheckingUsers)
   ocultamos spinners locales y placeholders para que solo se vea la
   superposición central `.setup-loading--overlay`. */
html[data-app-loading='true'] .loadingSpinner,
html[data-app-loading='true'] .loading-spinner,
html[data-app-loading='true'] i.fas.fa-spinner,
html[data-app-loading='true'] .loadingSpinner i,
html[data-app-loading='true'] .loading-spinner i {
  display: none !important;
  visibility: hidden !important;
  opacity: 0 !important;
}

/* Evitar box placeholders visibles (ej. cuadros vacíos durante carga de listas) */
html[data-app-loading='true'] .skeleton,
html[data-app-loading='true'] .placeholder,
html[data-app-loading='true'] .loading-placeholder {
  visibility: hidden !important;
  display: none !important;
}

/* Temporary global rule used by VideoCurriculum to mark header red between a segment
   of the video. This lives in the global stylesheet so it isn't affected by CSS
   Modules scoping and loads last for higher priority. */
/* Apply a visible red overlay without removing header pseudo-elements to
   avoid layout and stacking context side-effects that can affect inner widgets
   like the projects carousel. We use a semi-opaque linear-gradient and a
   strong inset glow so the header appears red while preserving internal
   overlays/backdrops. */
header#home.vc-header-red {
  background: linear-gradient(180deg, rgba(255, 0, 0, 0.14), rgba(255, 0, 0, 0.12)) !important;
  box-shadow:
    inset 0 0 120px rgba(255, 0, 0, 0.18),
    0 6px 24px rgba(0, 0, 0, 0.5) !important;
}

/* ===== Secciones + bleed (sin bandas) ===== */
.section {
  position: relative;
  overflow: visible; /* no cortar el bleed */
  border: 1px solid rgb(255, 255, 255, 0.02);
  box-shadow: 0 18px 60px -36px var(--ring) inset;
  padding-block: clamp(24px, 4vh, 64px);
  transition:
    background 420ms ease,
    box-shadow 420ms ease,
    padding-block 220ms ease;
  background: transparent; /* la decoración está en el fondo global */
}

/* fade inferior */
.section::after {
  content: '';
  position: absolute;
  left: 0;
  right: 0;
  bottom: -1px;
  height: clamp(56px, 8vh, 96px);
  background: var(--app-bg);
  mask-image: linear-gradient(to bottom, transparent 0%, #000 60%, #000 100%);
  transform: translateZ(0);
  pointer-events: none;
  z-index: -1;
}

/* fade superior cuando hay dos secciones seguidas */
.section + .section::before {
  content: '';
  position: absolute;
  left: 0;
  right: 0;
  top: -1px;
  height: clamp(56px, 8vh, 96px);
  background: var(--app-bg);
  mask-image: linear-gradient(to top, transparent 0%, #000 60%, #000 100%);
  transform: translateZ(0);
  pointer-events: none;
  z-index: -1;
}

/* ===== Anclas con offset por header sticky ===== */
[id] {
  scroll-margin-top: calc(var(--header-h) + 12px);
}

/* ===== Reveal simple ===== */
.reveal {
  opacity: 0;
  transform: translateY(10px);
  transition:
    opacity 0.44s ease,
    transform 0.44s ease;
}

.reveal.is-in {
  opacity: 1;
  transform: none;
}

@media (prefers-reduced-motion: reduce) {
  .reveal {
    transition: none;
    transform: none;
    opacity: 1;
  }
}

/* ===== Animación aurora ===== */
@keyframes auroraFloat {
  0% {
    transform: translate3d(-2%, -1%, 0) scale(1);
    opacity: 0.9;
  }

  50% {
    transform: translate3d(1%, 2%, 0) scale(1.03);
    opacity: 1;
  }

  100% {
    transform: translate3d(3%, -2%, 0) scale(1.01);
    opacity: 0.95;
  }
}
