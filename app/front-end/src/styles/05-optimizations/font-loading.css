/* Font Loading Optimization - Terminal Visual Improvements */

/* Load Poppins from Google Fonts for UI (weights used by design system) */
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');

/* ===========================================
   FONT PRELOADING AND OPTIMIZATION
   =========================================== */

/* Critical font preloading hints - these should be added to HTML head */

/*
<link rel="preload" href="/fonts/JetBrainsMono-Regular.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/JetBrainsMono-Medium.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/JetBrainsMono-Bold.woff2" as="font" type="font/woff2" crossorigin>
*/

/* ===========================================
   FONT FACE DECLARATIONS WITH OPTIMIZATION
   =========================================== */

/* JetBrains Mono - Primary terminal font */
@font-face {
  font-family: 'JetBrains Mono';
  src:
    local('JetBrains Mono Regular'),
    local('JetBrainsMono-Regular'),
    url('/fonts/JetBrainsMono-Regular.woff2') format('woff2'),
    url('/fonts/JetBrainsMono-Regular.woff') format('woff');
  font-weight: 400;
  font-style: normal;
  font-display: swap; /* Show fallback immediately, swap when loaded */
  unicode-range:
    U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074,
    U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'JetBrains Mono';
  src:
    local('JetBrains Mono Medium'),
    local('JetBrainsMono-Medium'),
    url('/fonts/JetBrainsMono-Medium.woff2') format('woff2'),
    url('/fonts/JetBrainsMono-Medium.woff') format('woff');
  font-weight: 500;
  font-style: normal;
  font-display: swap;
  unicode-range:
    U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074,
    U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'JetBrains Mono';
  src:
    local('JetBrains Mono Bold'),
    local('JetBrainsMono-Bold'),
    url('/fonts/JetBrainsMono-Bold.woff2') format('woff2'),
    url('/fonts/JetBrainsMono-Bold.woff') format('woff');
  font-weight: 700;
  font-style: normal;
  font-display: swap;
  unicode-range:
    U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074,
    U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

/* Fira Code - Secondary terminal font with ligatures */
@font-face {
  font-family: 'Fira Code';
  src:
    local('Fira Code Regular'),
    local('FiraCode-Regular'),
    url('/fonts/FiraCode-Regular.woff2') format('woff2'),
    url('/fonts/FiraCode-Regular.woff') format('woff');
  font-weight: 400;
  font-style: normal;
  font-display: swap;
  unicode-range:
    U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074,
    U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Fira Code';
  src:
    local('Fira Code Medium'),
    local('FiraCode-Medium'),
    url('/fonts/FiraCode-Medium.woff2') format('woff2'),
    url('/fonts/FiraCode-Medium.woff') format('woff');
  font-weight: 500;
  font-style: normal;
  font-display: swap;
  unicode-range:
    U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074,
    U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Fira Code';
  src:
    local('Fira Code Bold'),
    local('FiraCode-Bold'),
    url('/fonts/FiraCode-Bold.woff2') format('woff2'),
    url('/fonts/FiraCode-Bold.woff') format('woff');
  font-weight: 700;
  font-style: normal;
  font-display: swap;
  unicode-range:
    U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074,
    U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

/* ===========================================
   FONT LOADING STATES AND FALLBACKS
   =========================================== */

/* Font loading class to prevent FOIT (Flash of Invisible Text) */
.fonts-loading {
  visibility: hidden;
}

.fonts-loaded {
  visibility: visible;
}

/* Fallback styling while fonts are loading */
.font-mono {
  /* Ensure consistent metrics with fallback fonts */
  font-size-adjust: 0.5; /* Adjust x-height to match monospace fonts */
}

/* ===========================================
   PERFORMANCE OPTIMIZATIONS
   =========================================== */

/* Reduce font variations for better performance */
@supports (font-variation-settings: normal) {
  /* Use variable fonts if supported */
  @font-face {
    font-family: 'JetBrains Mono Variable';
    src: url('/fonts/JetBrainsMono-Variable.woff2') format('woff2-variations');
    font-weight: 100 800;
    font-style: normal;
    font-display: swap;
    unicode-range:
      U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074,
      U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
  }

  /* Update font stack to prefer variable font */
  :root {
    --font-mono:
      'JetBrains Mono Variable', 'JetBrains Mono', 'Fira Code', 'SF Mono', 'Monaco',
      'Cascadia Code', 'Consolas', 'Courier New', monospace;
  }
}

/* ===========================================
   FONT LOADING JAVASCRIPT INTEGRATION
   =========================================== */

/* Classes for JavaScript font loading detection */
.js-fonts-loading .terminal-font,
.js-fonts-loading .font-mono {
  /* Use system fonts while loading */
  font-family: Consolas, 'Courier New', monospace;
}

.js-fonts-loaded .terminal-font,
.js-fonts-loaded .font-mono {
  /* Switch to web fonts when loaded */
  font-family: var(--font-mono);
}

/* ===========================================
   REDUCED DATA MODE OPTIMIZATIONS
   =========================================== */

@media (prefers-reduced-data: reduce) {
  /* Skip web fonts and use system fonts only */
  .font-mono,
  .terminal-font {
    font-family: Consolas, Monaco, 'Courier New', monospace !important;
  }

  /* Disable font features that require additional data */
  .font-mono,
  .terminal-font {
    font-feature-settings: normal !important;
    font-variant-ligatures: none !important;
  }
}

/* ===========================================
   PRINT OPTIMIZATIONS
   =========================================== */

@media print {
  /* Use system fonts for printing to ensure compatibility */
  .font-mono,
  .terminal-font {
    font-family: 'Courier New', monospace !important;
    font-size: 10pt !important;
    line-height: 1.2 !important;
  }
}

/* ===========================================
   FONT LOADING ERROR HANDLING
   =========================================== */

/* Fallback when font loading fails */
@supports not (font-display: swap) {
  /* For older browsers, ensure fonts don't block rendering */
  .font-mono,
  .terminal-font {
    font-family: Consolas, Monaco, 'Courier New', monospace;
  }
}

/* ===========================================
   ACCESSIBILITY ENHANCEMENTS
   =========================================== */

/* Ensure fonts work well with screen readers */
.font-mono,
.terminal-font {
  /* Prevent synthetic font generation which can confuse screen readers */
  font-synthesis: none;

  /* Ensure proper text rendering */
  text-rendering: optimizelegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* Global font stack variables (use these in components) */
:root {
  --font-sans:
    'Inter', 'Poppins', system-ui, -apple-system, 'Segoe UI', roboto, 'Helvetica Neue', arial,
    sans-serif;
  --font-mono:
    'Fira Code', 'JetBrains Mono', 'SF Mono', 'Cascadia Code', 'Monaco', 'Consolas', monospace;
}

/* Apply monospace stack to terminal utility classes by default */
.font-mono,
.terminal-font {
  font-family: var(--font-mono);
}

/* High contrast mode adjustments */
@media (prefers-contrast: high) {
  .font-mono,
  .terminal-font {
    /* Use bolder weights for better visibility */
    font-weight: 500;

    /* Increase letter spacing for better readability */
    letter-spacing: 0.025em;
  }
}

/* Large text preferences */
@media (prefers-reduced-motion: reduce) {
  /* Disable any font-related animations */
  .font-mono,
  .terminal-font {
    transition: none !important;
    animation: none !important;
  }
}
