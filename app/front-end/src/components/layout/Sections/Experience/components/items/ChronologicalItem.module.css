/* ===================================================
   ChronologicalItem.module.css — Vista Cronológica
   Basado en el diseño mostrado en la imagen de referencia
   =================================================== */

/* ---------- CSS Layers para mejor organización ---------- */
@layer base, components, effects;

/* ---------- Variables CSS mejoradas ---------- */
:root {
  --chronological-spacing: 4rem;
  --chronological-marker-size: 60px;
  --chronological-border-radius: 20px;
  --chronological-transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  --chronological-z-background: 10;
  --chronological-z-content: 15;
  --chronological-z-marker: 100; /* Muy alto para estar por encima de las columnas */
  --chronological-z-dot: 110; /* Muy alto para estar por encima del rail */

  /* Colores adaptativos para modo oscuro */
  --chronological-card-bg: var(--md-sys-color-surface-1);
  --chronological-shadow-light: rgba(255, 255, 255, 0.08);
  --chronological-shadow-dark: rgba(0, 0, 0, 0.12);
}

/* Ajustes para modo oscuro */
@media (prefers-color-scheme: dark) {
  :root {
    --chronological-shadow-light: rgba(255, 255, 255, 0.03);
    --chronological-shadow-dark: rgba(0, 0, 0, 0.3);
  }
}

/* ---------- Item principal cronológico ---------- */
@layer components {
  .chronological-item {
    position: relative;
    display: flex;
    align-items: flex-start;
    margin-bottom: var(--chronological-spacing);
    min-height: 200px;
    animation: fade-up 0.8s cubic-bezier(0.23, 1.01, 0.32, 1) both;
    animation-fill-mode: both;
    contain: layout style;
    z-index: 99; /* Asegurar que todo el item esté por encima de las columnas */
    isolation: isolate; /* Crear contexto independiente */
  }
}

/* ---------- Posicionamiento izquierda/derecha ---------- */
.chronological-item.left {
  flex-direction: row-reverse;
  justify-content: flex-start;
  padding-left: 2rem;
}

.chronological-item.right {
  flex-direction: row;
  justify-content: flex-start;
  padding-right: 2rem;
}

/* ---------- Marcador cronológico ---------- */
.chronological-marker {
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  flex-direction: column;
  align-items: center;
  z-index: var(--chronological-z-marker);
  isolation: isolate; /* Crear nuevo contexto de apilamiento */
}

/* Asegurar que el marker siempre esté por encima del rail timeline */
.marker-dot {
  width: var(--chronological-marker-size);
  height: var(--chronological-marker-size);
  border-radius: 50%;
  border: 4px solid var(--md-sys-color-surface);
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
  z-index: var(--chronological-z-dot); /* z-index: 110 - Por encima del rail (z-index: 1) */
  transition: var(--chronological-transition);
  cursor: pointer;
  outline: none;
  isolation: isolate; /* Forzar contexto de apilamiento independiente */

  /* Forzar que esté por encima de cualquier rail */
  transform: translateZ(0); /* Activar aceleración hardware y contexto 3D */
}

.marker-dot:hover,
.marker-dot:focus-visible {
  transform: scale(1.1);
  outline: 2px solid var(--md-sys-color-primary);
  outline-offset: 4px;
}

/* Reducir movimiento para usuarios con preferencias de accesibilidad */
@media (prefers-reduced-motion: reduce) {
  .marker-dot:hover,
  .marker-dot:focus-visible {
    transform: none;
  }
}

/* Estilos específicos por tipo */
.marker-dot.experience {
  background: linear-gradient(135deg, rgb(124 141 255), rgb(154 124 255));
  box-shadow:
    0 0 0 3px var(--md-sys-color-surface),
    0 0 20px 6px rgb(124 141 255 / 0.5),
    0 0 40px 8px rgb(124 141 255 / 0.2);
}

.marker-dot.education {
  background: linear-gradient(135deg, rgb(45 212 191), rgb(56 178 172));
  box-shadow:
    0 0 0 3px var(--md-sys-color-surface),
    0 0 20px 6px rgb(45 212 191 / 0.5),
    0 0 40px 8px rgb(45 212 191 / 0.2);
}

.marker-dot i {
  color: white;
  font-size: 22px;
  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.4);
  filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.3));
}

/* ---------- Año externo (al lado del marcador) ---------- */
.chronological-year-external {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  background: linear-gradient(135deg, var(--md-sys-color-surface-2), var(--md-sys-color-surface-1));
  color: var(--md-sys-color-on-surface);
  padding: 8px 16px;
  border-radius: 24px;
  font-weight: 800;
  font-size: 0.9rem;
  border: 2px solid var(--md-sys-color-outline-variant);
  box-shadow:
    0 4px 12px rgba(0, 0, 0, 0.15),
    0 0 0 1px rgba(255, 255, 255, 0.1);
  white-space: nowrap;
  z-index: var(--chronological-z-marker);
  backdrop-filter: blur(8px);
  transition: var(--chronological-transition);
}

.chronological-year-external:hover {
  transform: translateY(-50%) scale(1.05);
  box-shadow:
    0 6px 16px rgba(0, 0, 0, 0.2),
    0 0 0 1px rgba(255, 255, 255, 0.15);
}

.chronological-item.left .chronological-year-external {
  left: -100px;
}

.chronological-item.right .chronological-year-external {
  right: -100px;
}

/* ---------- Contenido principal ---------- */
.cardWrapper {
  flex: 1;
  display: flex;
  max-width: 50%;
}

.chronological-item.left .cardWrapper {
  justify-content: flex-start;
  padding-right: 4rem;
}

.chronological-item.right .cardWrapper {
  justify-content: flex-end;
  padding-left: 4rem;
}

.chronological-content {
  width: 100%;
  background: var(--chronological-card-bg);
  border: 1px solid var(--md-sys-color-outline-variant);
  border-radius: var(--chronological-border-radius);
  padding: 28px;
  box-shadow:
    0 8px 32px var(--chronological-shadow-dark),
    0 0 0 1px var(--chronological-shadow-light),
    inset 0 1px 0 rgba(255, 255, 255, 0.1);
  position: relative;
  overflow: hidden;
  transition: var(--chronological-transition);
  backdrop-filter: blur(12px);
  contain: layout style paint;
  transform: translate3d(0, 0, 0); /* Forzar aceleración de hardware */
}

.chronological-content::before {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(
    135deg,
    rgba(255, 255, 255, 0.05) 0%,
    transparent 50%,
    rgba(0, 0, 0, 0.02) 100%
  );
  pointer-events: none;
  border-radius: inherit;
}

.chronological-content:hover {
  transform: translate3d(0, -6px, 0) scale(1.02);
  box-shadow:
    0 16px 48px rgba(0, 0, 0, 0.18),
    0 0 0 1px rgba(255, 255, 255, 0.12),
    inset 0 1px 0 rgba(255, 255, 255, 0.15);
  will-change: transform, box-shadow;
}

/* .chronological-item.left .chronological-content {
  margin-right: 4rem;
}

.chronological-item.right .chronological-content {
  margin-left: 4rem;
} */

/* ---------- Media de la tarjeta ---------- */
.card-media {
  position: relative;
  margin: -28px -28px 24px -28px;
  height: 140px;
  overflow: hidden;
  border-radius: 20px 20px 0 0;
  background: linear-gradient(135deg, rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.05));
}

.card-media img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  object-position: center;
  filter: saturate(0.95) brightness(0.9) contrast(1.05);
  transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

.chronological-content:hover .card-media img {
  transform: scale(1.08);
  filter: saturate(1.1) brightness(1) contrast(1.1);
}

.pill.period {
  position: absolute;
  bottom: 16px;
  right: 16px;
  background: rgba(0, 0, 0, 0.85);
  color: white;
  padding: 8px 16px;
  border-radius: 24px;
  font-size: 0.8rem;
  font-weight: 700;
  backdrop-filter: blur(12px);
  display: flex;
  align-items: center;
  gap: 8px;
  border: 1px solid rgba(255, 255, 255, 0.2);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
}

/* ---------- Header del contenido ---------- */
.chronological-header {
  margin-bottom: 12px;
}

.chronological-type {
  display: inline-block;
  padding: 6px 16px;
  border-radius: 24px;
  font-size: 0.75rem;
  font-weight: 800;
  text-transform: uppercase;
  letter-spacing: 0.8px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  cursor: default;
  margin-bottom: 12px;
  user-select: none;
  border: 1.5px solid transparent;
  box-shadow:
    0 2px 8px rgba(0, 0, 0, 0.1),
    inset 0 1px 0 rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(8px);
}

.chronological-type i {
  margin-right: 8px;
  font-size: 1rem;
  vertical-align: middle;
}

.chronological-type.experience {
  background: linear-gradient(135deg, rgb(124 141 255 / 0.25), rgb(154 124 255 / 0.2));
  color: rgb(124 141 255);
  border: 1.5px solid rgb(124 141 255 / 0.4);
  box-shadow:
    0 2px 8px rgb(124 141 255 / 0.2),
    inset 0 1px 0 rgba(255, 255, 255, 0.1);
}

.chronological-type.education {
  background: linear-gradient(135deg, rgb(45 212 191 / 0.25), rgb(56 178 172 / 0.2));
  color: rgb(45 212 191);
  border: 1.5px solid rgb(45 212 191 / 0.4);
  box-shadow:
    0 2px 8px rgb(45 212 191 / 0.2),
    inset 0 1px 0 rgba(255, 255, 255, 0.1);
}

.chronological-type:hover {
  transform: scale(1.05);
}

.chronological-type.experience:hover {
  background: linear-gradient(135deg, rgb(124 141 255 / 0.35), rgb(154 124 255 / 0.3));
  box-shadow:
    0 4px 12px rgb(124 141 255 / 0.3),
    inset 0 1px 0 rgba(255, 255, 255, 0.15);
}

.chronological-type.education:hover {
  background: linear-gradient(135deg, rgb(45 212 191 / 0.35), rgb(56 178 172 / 0.3));
  box-shadow:
    0 4px 12px rgb(45 212 191 / 0.3),
    inset 0 1px 0 rgba(255, 255, 255, 0.15);
}

/* ---------- Título ---------- */
.chronological-title {
  margin: 0 0 16px 0;
  font-size: 1.5rem;
  font-weight: 800;
  color: var(--md-sys-color-on-surface);
  line-height: 1.3;
}

.chronological-title i {
  padding-right: 8px;
  color: var(--md-sys-color-primary);
}

/* ---------- Meta información ---------- */
.meta-row {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 12px;
  color: var(--md-sys-color-on-surface-variant);
  font-weight: 600;
}

.meta-row i {
  color: var(--md-sys-color-primary);
  width: 16px;
}

/* ---------- Período y duración ---------- */
.chronological-period,
.chronological-duration {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 8px;
  color: var(--md-sys-color-on-surface-variant);
  font-size: 0.875rem;
}

.chronological-period i,
.chronological-duration i {
  color: var(--md-sys-color-primary);
  width: 16px;
}

/* ---------- Descripción ---------- */
.chronological-description {
  margin: 16px 0;
  color: var(--md-sys-color-on-surface-variant);
  line-height: 1.6;
  font-size: 0.9rem;
}

/* ---------- Habilidades ---------- */
.chronological-skills {
  margin-top: 20px;
}

.skills-label {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 12px;
  color: var(--md-sys-color-on-surface);
  font-weight: 600;
  font-size: 0.875rem;
}

.skills-label i {
  color: var(--md-sys-color-primary);
  width: 16px;
}

.skills-tags {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
}

/* Tooltip solo en hover dentro de ChronologicalItem (override a stackIcon--active por especificidad) */
.skills-tags :global(.stackIcon .skillHoverLabel) {
  opacity: 0;
}
/* Corregir scoping: aplicar :global también a .skillHoverLabel en la regla de hover */
.skills-tags :global(.stackIcon:hover .skillHoverLabel),
.skills-tags :global(.stackIcon.stackIcon--active:hover .skillHoverLabel) {
  opacity: 1;
}

/* ---------- Habilidades ---------- */
.chronological-skills {
  margin-top: 24px; /* Incrementado de 20px a 24px */
}

.skills-label {
  display: flex;
  align-items: center;
  gap: 10px; /* Incrementado de 8px a 10px */
  margin-bottom: 16px; /* Incrementado de 12px a 16px */
  color: var(--md-sys-color-on-surface);
  font-weight: 600;
  font-size: 0.9rem; /* Incrementado de 0.875rem a 0.9rem */
}

.skills-label i {
  color: var(--md-sys-color-primary);
  width: 18px; /* Incrementado de 16px a 18px */
}

.skills-tags {
  display: flex;
  flex-wrap: wrap;
  gap: 12px; /* Incrementado de 8px a 12px */
  color: var(--md-sys-color-on-surface);
}

/* Tooltip solo en hover dentro de ChronologicalCard */
.skills-tags :global(.stackIcon .skillHoverLabel) {
  opacity: 0;
}

.skills-tags :global(.stackIcon:hover .skillHoverLabel),
.skills-tags :global(.stackIcon.stackIcon--active:hover .skillHoverLabel) {
  opacity: 1;
}

/* ---------- Calificación educativa ---------- */
.education-grade {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-top: 16px;
  padding: 12px 16px;
  background: linear-gradient(135deg, rgb(45 212 191 / 0.1), rgb(56 178 172 / 0.05));
  border: 1px solid rgb(45 212 191 / 0.2);
  border-radius: 12px;
  color: var(--md-sys-color-on-surface);
  font-weight: 600;
}

.education-grade i {
  color: rgb(45 212 191);
  font-size: 1.1rem;
}

/* ---------- Animaciones ---------- */
@keyframes fade-up {
  from {
    opacity: 0;
    transform: translateY(30px) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

/* Respeto por las preferencias de reducción de movimiento */
@media (prefers-reduced-motion: reduce) {
  .chronological-item {
    animation: none;
  }

  .chronological-content:hover,
  .marker-dot:hover,
  .chronological-year-external:hover,
  .chronological-type:hover {
    transform: none;
  }

  .chronological-content:hover .card-media img {
    transform: none;
  }

  @keyframes fade-up {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }
}

/* ---------- Responsive mejorado con container queries ---------- */
.chronological-item {
  container-type: inline-size;
  container-name: chronological-item;
}

/* Container queries para mejor responsive */
@container chronological-item (max-width: 1024px) {
  .chronological-content {
    max-width: 45%;
    padding: 24px;
  }

  .chronological-item.left .chronological-content {
    margin-right: 3rem;
  }

  .chronological-item.right .chronological-content {
    margin-left: 3rem;
  }
}

@media (max-width: 1024px) {
  .chronological-content {
    max-width: 45%;
    padding: 24px;
  }

  .chronological-item.left .chronological-content {
    margin-right: 3rem;
  }

  .chronological-item.right .chronological-content {
    margin-left: 3rem;
  }

  .chronological-year-external {
    font-size: 0.85rem;
    padding: 6px 14px;
  }

  .chronological-item.left .chronological-year-external {
    left: -90px;
  }

  .chronological-item.right .chronological-year-external {
    right: -90px;
  }
}

@media (max-width: 768px) {
  .chronological-item {
    flex-direction: column !important;
    align-items: center;
    margin-bottom: 3rem;
    padding: 0 !important;
    min-height: auto;
  }

  .chronological-item.left,
  .chronological-item.right {
    justify-content: center;
  }

  .chronological-content {
    max-width: 100%;
    margin: 0 !important;
    margin-top: 2rem !important;
    padding: 20px;
  }

  .chronological-marker {
    position: relative;
    left: auto;
    transform: none;
    margin-bottom: 1rem;
  }

  .chronological-year-external {
    position: static;
    transform: none;
    margin-top: 12px;
    left: auto !important;
    right: auto !important;
  }

  .card-media {
    margin: -20px -20px 20px -20px;
    height: 120px;
  }
}

@media (max-width: 480px) {
  .chronological-title {
    font-size: 1.25rem;
  }

  .chronological-content {
    padding: 18px;
  }

  .card-media {
    margin: -18px -18px 18px -18px;
    height: 100px;
  }

  .marker-dot {
    width: 50px;
    height: 50px;
  }

  .marker-dot i {
    font-size: 18px;
  }
}
